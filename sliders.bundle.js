webpackJsonp([1],{1036:function(e,t,n){var r=n(583);"string"==typeof r&&(r=[[e.i,r,""]]);n(36)(r,{});r.locals&&(e.exports=r.locals)},1050:function(e,t,n){e.exports=n(365)},233:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=n(1036),l=(n.n(s),n(3)),c=n.n(l),u=n(21),d=(n.n(u),n(234)),p=n(375),m=n(376),f=n(138),h=n.n(f),g=n(146);n.n(g);n.d(t,"a",function(){return k});var y,b,w=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S={full:n(824),static:n(825),addSagaImports:n(822),addSagaStart:n(823)},k=(y=n.i(u.kea)({actions:function(){return{toggleFeature:function(e){return{feature:e}}}},reducers:function(e){var t=e.actions;return{features:[{},l.PropTypes.object,i({},t.toggleFeature,function(e,t){var n=t.feature;return v({},e,i({},n,!e[n]))})]}}}),y(b=function(e){function t(){return r(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),w(t,[{key:"render",value:function(){var e=this.props.features,t=this.actions.toggleFeature;return c.a.createElement("div",{className:"sliders-scene"},c.a.createElement("div",{className:"description"},c.a.createElement("h2",null,"Example #3 - Sliders"),"This example demonstrates side effects through sagas.",c.a.createElement("br",null),c.a.createElement("br",null),"We will build a slider that will update its image every 5 seconds.",c.a.createElement("h2",null,"Final result"),"The final result will look like this:",c.a.createElement("div",{className:"demo"},c.a.createElement("div",{className:"slider-container"},c.a.createElement(d.a,{id:1,initialSlide:0}))),"Whenever you press any of the dots the counter reset.",c.a.createElement("h2",null,"1. The static component"),"Based on knowledge from the previous chapers, you should be able to build a static slider.",c.a.createElement("br",null),c.a.createElement("br",null),"The code for it will look something like this:",c.a.createElement(h.a,{className:"javascript"},S.static),"This will give us the following result:",c.a.createElement("div",{className:"demo"},c.a.createElement("div",{className:"slider-container"},c.a.createElement(p.a,null))),"Click it! It works! But it won't change the slides automatically.",c.a.createElement("h2",null,"2. Just Add Sagas"),"For that we need to write some sagas.",c.a.createElement("br",null),c.a.createElement("br",null),"Sagas provide a nice way to write code that has side effects. They might be unfamiliar at first, but when you get to know them, you'll wonder how you ever wrote your frontend code without them.",c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("button",{onClick:function(){return t("decorators")}},"I need to brush up on my Sagas"),c.a.createElement("br",null),e.decorators?c.a.createElement("div",{className:"extra-help"},"Coming soon! For now, please read the documentation for ",c.a.createElement("a",{href:"https://redux-saga.js.org/"},"redux-saga"),".",c.a.createElement("br",null),c.a.createElement("br",null),"For this example it's important that you understand how the ",c.a.createElement("code",null,"put"),", ",c.a.createElement("code",null,"take")," and ",c.a.createElement("code",null,"race")," effects work. ",c.a.createElement("code",null,"takeEvery")," is nice to know as well!"):null,c.a.createElement("br",null),"First we must import the ",c.a.createElement("code",null,"redux-saga/effects")," that we need. We'll also import a ",c.a.createElement("code",null,"delay")," effect that just sleeps for the given amount of milliseconds.",c.a.createElement(h.a,{className:"javascript"},S.addSagaImports),"And then we create a ",c.a.createElement("code",null,"start")," generator function inside ",c.a.createElement("code",null,"@kea({})"),". This function is called every time your component is mounted.",c.a.createElement("br",null),c.a.createElement("br",null),"Inside this function we create a ",c.a.createElement("code",null,"race")," condition between two competing effects: a delay of 5 sec and the action ",c.a.createElement("code",null,"updateSlide")," being triggered. The code pauses at the ",c.a.createElement("code",null,"yield race()")," call until one of the two conditions comes through.",c.a.createElement("br",null),c.a.createElement("br",null),"In case it was the timeout that happened, we fetch the latest slide (",c.a.createElement("code",null,"yield this.get(..)")," is a shorthand to use the selectors defined in ",c.a.createElement("code",null,"@kea({})"),")... and then we dispatch (",c.a.createElement("code",null,"yield put"),") the ",c.a.createElement("code",null,"updateSlide")," action with the next slide.",c.a.createElement(h.a,{className:"javascript"},S.addSagaStart),"All of this results in this:",c.a.createElement("div",{className:"demo"},c.a.createElement("div",{className:"slider-container"},c.a.createElement(m.a,null))),"Now if you will always just have one slider on your screen, you're done. If you wish to run many, you will run into the same issue as with the dynamic counter example - both sliders will listen to and react to the ",c.a.createElement("code",null,"updateSlide")," actions unless you explicitly prohibit them.",c.a.createElement("br",null),c.a.createElement("br",null),"The code below demonstrates a way to prevent this from happening. It also shows the other saga functions that are available in kea."),c.a.createElement("div",{className:"code"},c.a.createElement("h2",null,"Full source"),"Better documentation is coming soon. Until then, read the comments in the code and the ",c.a.createElement("a",{href:"https://redux-saga.js.org/"},"redux-saga")," documentation.",c.a.createElement(h.a,{className:"javascript"},S.full)))}}]),t}(l.Component))||b)},365:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(24),a=(n.n(r),n(233));t.default=n.i(r.createScene)({name:"sliders",component:a.a})},375:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=n(228),l=(n.n(s),n(3)),c=n.n(l),u=n(21),d=(n.n(u),n(150)),p=n(148);n.d(t,"a",function(){return g});var m,f,h=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),g=(m=n.i(u.kea)({actions:function(){return{updateSlide:function(e){return{index:e}}}},reducers:function(e){var t=e.actions;return{currentSlide:[0,l.PropTypes.number,i({},t.updateSlide,function(e,t){return t.index%p.a.length})]}},selectors:function(e){var t=e.selectors;return{currentImage:[function(){return[t.currentSlide]},function(e){return p.a[e]},l.PropTypes.object]}}}),m(f=function(e){function t(){return r(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),h(t,[{key:"render",value:function(){var e=this.props,t=e.currentSlide,r=e.currentImage,a=this.actions.updateSlide,o="Image copyright by "+r.author;return c.a.createElement("div",{className:"kea-slider"},c.a.createElement("img",{src:r.src,alt:o,title:o}),c.a.createElement("div",{className:"buttons"},n.i(d.a)(p.a.length).map(function(e){return c.a.createElement("span",{key:e,className:e===t?"selected":"",onClick:function(){return a(e)}})})))}}]),t}(l.Component))||f)},376:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var s=n(228),l=(n.n(s),n(3)),c=n.n(l),u=n(21),d=(n.n(u),n(62)),p=n(150),m=n(149),f=n(148);n.d(t,"a",function(){return b});var h,g,y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),b=(h=n.i(u.kea)({actions:function(){return{updateSlide:function(e){return{index:e}}}},reducers:function(e){var t=e.actions;return{currentSlide:[0,l.PropTypes.number,i({},t.updateSlide,function(e,t){return t.index%f.a.length})]}},selectors:function(e){var t=e.selectors;return{currentImage:[function(){return[t.currentSlide]},function(e){return f.a[e]},l.PropTypes.object]}},start:regeneratorRuntime.mark(function e(){var t,r,a,o,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.actions.updateSlide,console.log("Starting homepage slider saga"),console.log(this,this.actions,this.props);case 3:return e.next=6,n.i(d.race)({change:n.i(d.take)(function(e){return e.type===t.toString()&&e.payload.key===i.key}),timeout:n.i(m.a)(5e3)});case 6:if(r=e.sent,a=r.timeout,!a){e.next=14;break}return e.next=11,this.get("currentSlide");case 11:return o=e.sent,e.next=14,n.i(d.put)(t(o+1));case 14:e.next=3;break;case 16:case"end":return e.stop()}},e,this)})}),h(g=function(e){function t(){return r(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),y(t,[{key:"render",value:function(){var e=this.props,t=e.currentSlide,r=e.currentImage,a=this.actions.updateSlide,o="Image copyright by "+r.author;return c.a.createElement("div",{className:"kea-slider"},c.a.createElement("img",{src:r.src,alt:o,title:o}),c.a.createElement("div",{className:"buttons"},n.i(p.a)(f.a.length).map(function(e){return c.a.createElement("span",{key:e,className:e===t?"selected":"",onClick:function(){return a(e)}})})))}}]),t}(l.Component))||g)},384:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(24),a=(n.n(r),n(233));t.default=n.i(r.createScene)({name:"sliders",component:a.a})},583:function(e,t,n){t=e.exports=n(33)(),t.push([e.i,".sliders-scene {\n  text-align: center;\n}\n.sliders-scene .slider-container {\n  max-width: 500px;\n  margin: 0 auto;\n}\n",""])},822:function(e,t){e.exports="import { take, race, put } from 'redux-saga/effects'\nimport delay from '~/utils/delay'\n"},823:function(e,t){e.exports="@kea({\n  actions: () => ({\n    updateSlide: index => ({ index })\n  }),\n\n  // ...\n\n  // run this saga when the component is mounted\n  start: function * () {\n    const { updateSlide } = this.actions\n\n    while (true) {\n      const { timeout } = yield race({\n        change: take(updateSlide.toString()),\n        timeout: delay(5000)\n      })\n\n      if (timeout) {\n        const currentSlide = yield this.get('currentSlide')\n        yield put(updateSlide(currentSlide + 1))\n      }\n    }\n  }\n})\nexport default class StaticSlider extends Component {\n  // as it was\n}\n"},824:function(e,t){e.exports="// slider/index.js\nimport './styles.scss'\n\nimport React, { Component, PropTypes } from 'react'\nimport { kea } from 'kea'\n\nimport { take, race, put } from 'redux-saga/effects'\n\nimport delay from '~/utils/delay'\nimport range from '~/utils/range'\n\nimport images from './images'\n\n@kea({\n  key: (props) => props.id,\n\n  path: (key) => ['scenes', 'homepage', 'slider', key],\n\n  actions: () => ({\n    updateSlide: index => ({ index })\n  }),\n\n  reducers: ({ actions, key, props }) => ({\n    currentSlide: [props.initialSlide || 0, PropTypes.number, {\n      [actions.updateSlide]: (state, payload) => {\n        return payload.key === key ? payload.index % images.length : state\n      }\n    }]\n  }),\n\n  selectors: ({ selectors }) => ({\n    currentImage: [\n      () => [selectors.currentSlide],\n      (currentSlide) => images[currentSlide],\n      PropTypes.object\n    ]\n  }),\n\n  // This saga is run when the component is mounted.\n  // The function is a regular redux-saga worker that has access to:\n  // 1) this.actions, 2) this.key and 3) this.props\n  //\n  // Read the redux-saga documentation to understand the different\n  // functions like: race(), put(), take(), etc\n  start: function * () {\n    const { updateSlide } = this.actions\n\n    console.log('Starting homepage slider saga')\n    // console.log(this, this.actions, this.props)\n\n    while (true) {\n      // wait until the updateSlide() action is triggered or a 5sec timeout occurs\n      // to ignore actions from other slider instances we must also match the key\n      const { timeout } = yield race({\n        change: take(action => action.type === updateSlide.toString() &&\n                               action.payload.key === this.key),\n        timeout: delay(5000)\n      })\n\n      if (timeout) {\n        // use this.get(..) to select the latest data from redux\n        const currentSlide = yield this.get('currentSlide')\n\n        // actions are not automatically bound to dispatch, so\n        // you must use redux-saga's put() with them\n        yield put(updateSlide(currentSlide + 1))\n      }\n    }\n  },\n\n  // this saga is run when the component is unmounted\n  stop: function * () {\n    console.log('Stopping homepage slider saga')\n  },\n\n  // The redux-saga takeEvery function.\n  // It waits for actions and runs the relevant functions.\n  // Also available: takeLatest\n  takeEvery: ({ actions, workers }) => ({\n    [actions.updateSlide]: workers.updateSlide\n  }),\n\n  // it's recommended to group all the logic under the workers: {} object.\n  workers: {\n    updateSlide: function * (action) {\n      // check if it was this component that triggered the action\n      if (action.payload.key === this.key) {\n        console.log('slide update triggered', action.payload.key, this.key, this.props.id)\n        // console.log(action, this)\n      }\n    }\n  }\n})\nexport default class Slider extends Component {\n  render () {\n    const { currentSlide, currentImage } = this.props\n    const { updateSlide } = this.actions\n\n    const title = `Image copyright by ${currentImage.author}`\n\n    return (\n      <div className='kea-slider'>\n        <img src={currentImage.src} alt={title} title={title} />\n        <div className='buttons'>\n          {range(images.length).map(i => (\n            <span key={i}\n                  className={i === currentSlide ? 'selected' : ''}\n                  onClick={() => updateSlide(i)} />\n          ))}\n        </div>\n      </div>\n    )\n  }\n}\n\n// index.js\nexport default class SlidersScene extends Component {\n  render () {\n    return (\n      <div className='slider-container'>\n        <Slider id={1} initialSlide={0} />\n        <Slider id={2} initialSlide={1} />\n      </div>\n    )\n  }\n}\n\n"},825:function(e,t){e.exports="import React, { Component, PropTypes } from 'react'\nimport { kea } from 'kea'\n\nimport images from './images'     // array of objects [{ src, author }, ...]\nimport range from '~/utils/range' // helper, range(3) === [0, 1, 2]\n\n@kea({\n  actions: () => ({\n    updateSlide: index => ({ index })\n  }),\n\n  reducers: ({ actions }) => ({\n    currentSlide: [0, PropTypes.number, {\n      [actions.updateSlide]: (state, payload) => payload.index % images.length\n    }]\n  }),\n\n  selectors: ({ selectors }) => ({\n    currentImage: [\n      () => [selectors.currentSlide],\n      (currentSlide) => images[currentSlide],\n      PropTypes.object\n    ]\n  })\n})\nexport default class Slider extends Component {\n  render () {\n    const { currentSlide, currentImage } = this.props\n    const { updateSlide } = this.actions\n\n    const title = `Image copyright by ${currentImage.author}`\n\n    return (\n      <div className='kea-slider'>\n        <img src={currentImage.src} alt={title} title={title} />\n        <div className='buttons'>\n          {range(images.length).map(i => (\n            <span key={i}\n                  className={i === currentSlide ? 'selected' : ''}\n                  onClick={() => updateSlide(i)} />\n          ))}\n        </div>\n      </div>\n    )\n  }\n}\n"}},[1050]);